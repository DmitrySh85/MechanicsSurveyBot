2024-07-15 14:06:22,251 - aiogram.dispatcher - INFO - Run polling for bot @S_hakirov_bot id=5955659888 - 'ShakirBot'
2024-07-15 14:06:45,874 - aiogram.event - INFO - Update id=948208000 is handled. Duration 1092 ms by bot id=5955659888
2024-07-15 14:06:54,219 - aiogram.event - INFO - Update id=948208001 is handled. Duration 296 ms by bot id=5955659888
2024-07-15 14:06:59,782 - aiogram.event - INFO - Update id=948208002 is not handled. Duration 0 ms by bot id=5955659888
2024-07-15 14:06:59,783 - aiogram.event - ERROR - Cause exception while process update id=948208002 by bot id=5955659888
KeyError: 'answer_letter'
Traceback (most recent call last):
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 49, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 142, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 137, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 170, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 142, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 137, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 162, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\src\handlers\handlers.py", line 133, in second_answer_handler
    await process_answer(callback_query, valid_answer, state)
  File "C:\Python\MechanicsSurveyBot\src\services\handlers_services.py", line 69, in process_answer
    await callback_query.message.answer(INCORRECT_ANSWER_TEXT.format(answer_letter, valid_answer_letter))
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'answer_letter'
2024-07-15 14:10:45,455 - aiogram.dispatcher - INFO - Polling stopped
2024-07-15 14:10:45,715 - aiogram.dispatcher - INFO - Polling stopped for bot @S_hakirov_bot id=5955659888 - 'ShakirBot'
2024-07-15 14:11:08,092 - aiogram.dispatcher - INFO - Start polling
2024-07-15 14:11:08,418 - aiogram.dispatcher - INFO - Run polling for bot @S_hakirov_bot id=5955659888 - 'ShakirBot'
2024-07-15 14:11:28,748 - aiogram.event - INFO - Update id=948208003 is handled. Duration 1139 ms by bot id=5955659888
2024-07-15 14:11:32,938 - aiogram.event - INFO - Update id=948208004 is handled. Duration 219 ms by bot id=5955659888
2024-07-15 14:11:38,713 - aiogram.event - INFO - Update id=948208005 is handled. Duration 250 ms by bot id=5955659888
2024-07-15 14:11:50,940 - aiogram.event - INFO - Update id=948208006 is handled. Duration 344 ms by bot id=5955659888
2024-07-15 14:12:02,549 - aiogram.event - INFO - Update id=948208007 is handled. Duration 250 ms by bot id=5955659888
2024-07-15 14:12:10,922 - aiogram.event - INFO - Update id=948208008 is not handled. Duration 500 ms by bot id=5955659888
2024-07-15 14:12:10,923 - aiogram.event - ERROR - Cause exception while process update id=948208008 by bot id=5955659888
KeyError: 'user_first_name'
Traceback (most recent call last):
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 49, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 142, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 137, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 170, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 142, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 137, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 162, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\src\handlers\handlers.py", line 170, in fifth_answer_handler
    await send_survey_results_to_admin(callback_query, valid_answers_count)
  File "C:\Python\MechanicsSurveyBot\src\services\handlers_services.py", line 96, in send_survey_results_to_admin
    admin_message_text = await get_final_message_text_for_admin(callback_query, valid_answers_count)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\src\services\handlers_services.py", line 111, in get_final_message_text_for_admin
    message_text = ADMIN_FINAL_MESSAGE.format(user_first_name, user_last_name, valid_answers_count)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'user_first_name'
2024-07-15 14:12:26,173 - aiogram.dispatcher - INFO - Polling stopped
2024-07-15 14:12:26,429 - aiogram.dispatcher - INFO - Polling stopped for bot @S_hakirov_bot id=5955659888 - 'ShakirBot'
2024-07-15 14:12:49,694 - aiogram.dispatcher - INFO - Start polling
2024-07-15 14:12:49,950 - aiogram.dispatcher - INFO - Run polling for bot @S_hakirov_bot id=5955659888 - 'ShakirBot'
2024-07-15 14:12:54,357 - aiogram.event - INFO - Update id=948208009 is handled. Duration 1062 ms by bot id=5955659888
2024-07-15 14:12:59,587 - aiogram.event - INFO - Update id=948208010 is handled. Duration 250 ms by bot id=5955659888
2024-07-15 14:13:07,680 - aiogram.event - INFO - Update id=948208011 is handled. Duration 187 ms by bot id=5955659888
2024-07-15 14:13:19,546 - aiogram.event - INFO - Update id=948208012 is handled. Duration 280 ms by bot id=5955659888
2024-07-15 14:13:31,311 - aiogram.event - INFO - Update id=948208013 is handled. Duration 234 ms by bot id=5955659888
2024-07-15 14:13:39,121 - aiogram.event - INFO - Update id=948208014 is not handled. Duration 608 ms by bot id=5955659888
2024-07-15 14:13:39,123 - aiogram.event - ERROR - Cause exception while process update id=948208014 by bot id=5955659888
KeyError: 'user_first_name'
Traceback (most recent call last):
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 49, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 142, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 137, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 170, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 142, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 137, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 162, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\src\handlers\handlers.py", line 170, in fifth_answer_handler
    await send_survey_results_to_admin(callback_query, valid_answers_count)
  File "C:\Python\MechanicsSurveyBot\src\services\handlers_services.py", line 96, in send_survey_results_to_admin
    admin_message_text = await get_final_message_text_for_admin(callback_query, valid_answers_count)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\MechanicsSurveyBot\src\services\handlers_services.py", line 111, in get_final_message_text_for_admin
    message_text = ADMIN_FINAL_MESSAGE.format(user_first_name, user_last_name, valid_answers_count)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'user_first_name'
2024-07-15 14:14:42,120 - aiogram.dispatcher - INFO - Polling stopped
2024-07-15 14:14:42,384 - aiogram.dispatcher - INFO - Polling stopped for bot @S_hakirov_bot id=5955659888 - 'ShakirBot'
2024-07-15 14:14:59,151 - aiogram.dispatcher - INFO - Start polling
2024-07-15 14:14:59,513 - aiogram.dispatcher - INFO - Run polling for bot @S_hakirov_bot id=5955659888 - 'ShakirBot'
2024-07-15 14:15:30,421 - aiogram.event - INFO - Update id=948208015 is handled. Duration 1297 ms by bot id=5955659888
2024-07-15 14:15:41,525 - aiogram.event - INFO - Update id=948208016 is handled. Duration 297 ms by bot id=5955659888
2024-07-15 14:15:54,366 - aiogram.event - INFO - Update id=948208017 is handled. Duration 250 ms by bot id=5955659888
2024-07-15 14:16:04,989 - aiogram.event - INFO - Update id=948208018 is handled. Duration 437 ms by bot id=5955659888
2024-07-15 14:16:13,260 - aiogram.event - INFO - Update id=948208019 is handled. Duration 344 ms by bot id=5955659888
2024-07-15 14:16:22,527 - aiogram.event - INFO - Update id=948208020 is not handled. Duration 750 ms by bot id=5955659888
